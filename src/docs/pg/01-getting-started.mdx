
# 시작하기

헥토파이낸셜 전자결제(PG) 서비스에 오신 것을 환영합니다! 이 가이드를 통해 빠르고 안전하게 결제 서비스를 연동할 수 있습니다.

## 개요

### 헥토파이낸셜 PG 서비스란?

헥토파이낸셜 전자결제(PG) 서비스는 **신용카드, 실시간 계좌이체, 가상계좌, 휴대폰 결제, 상품권 결제** 등 다양한 온라인 결제수단을 지원하는 통합 결제 서비스입니다.

### 주요 특징

<FeatureGrid features={[
  {
    icon: "💳",
    title: "다양한 결제수단",
    description: "신용카드부터 간편결제까지 모든 주요 결제수단을 하나의 API로 지원",
    bgColor: "from-hecto-50 to-hecto-100",
    borderColor: "border-hecto-200",
    iconBgColor: "bg-hecto-400"
  },
  {
    icon: "🔒",
    title: "강력한 보안",
    description: "PCI DSS 준수, AES-256 암호화, 해시 검증으로 안전한 결제 환경 제공",
    bgColor: "from-hecto-50 to-hecto-100",
    borderColor: "border-hecto-200",
    iconBgColor: "bg-hecto-400"
  },
  {
    icon: "⚡",
    title: "빠른 연동",
    description: "표준 API와 SDK를 통한 쉽고 빠른 연동, 샘플 코드 제공",
    bgColor: "from-hecto-50 to-hecto-100",
    borderColor: "border-hecto-200",
    iconBgColor: "bg-hecto-400"
  },
  {
    icon: "📊",
    title: "실시간 관리",
    description: "실시간 거래 조회, 정산 관리, 상세한 통계 데이터 제공",
    bgColor: "from-hecto-50 to-hecto-100",
    borderColor: "border-hecto-200",
    iconBgColor: "bg-hecto-400"
  }
]} />

### 이 문서의 대상

이 문서는 **헥토파이낸셜 전자결제(PG) 시스템을 통해 결제를 연동하려는 개발자**를 대상으로 합니다.

### 문서 사용법

> **팁**: 본 문서를 완독할 필요는 없습니다! 결제 수단별로 나누어져 있으니 필요한 부분만 참고하세요.

**문서 표기법:**
- 🟢 **필수** 파라미터: 반드시 포함해야 하는 필드
- 🟡 **선택** 파라미터: 필요에 따라 포함하는 필드
- **데이터 타입**: 한글, 영문, 숫자 String 테이터 타입
- **길이**: UTF-8 인코딩 기준 바이트 수

---


## 환경

### 테스트베드 서버 정보

테스트 및 개발을 위한 환경 정보입니다:

<ParameterCard
  name="테스트베드 도메인"
  type="URL"
  required={true}
  description="헥토파이낸셜 테스트베드 결제창 서버 도메인입니다."
  example="tbnpg.settlebank.co.kr"
/>

<ParameterCard
  name="테스트베드 IP (결제창)"
  type="IP Address"
  required={false}
  description="테스트베드 결제창 서버의 IP 주소입니다. 방화벽 설정 시 참고하세요."
  example="61.252.169.51"
  note="HTTPS(TCP/443) 포트를 사용합니다."
/>

<ParameterCard
  name="API 서버 도메인"
  type="URL"
  required={true}
  description="Non-UI API 서비스를 위한 테스트베드 도메인입니다."
  example="tbgw.settlebank.co.kr"
/>

<ParameterCard
  name="API 서버 IP (테스트베드)"
  type="IP Address"
  required={false}
  description="테스트베드 API 서버의 IP 주소입니다."
  example="61.252.169.42"
  note="취소 및 기타 API 서비스용 IP입니다."
/>

### 운영 환경 서버 정보

운영을 위한 환경 정보입니다:

<ParameterCard
  name="운영 결제창 도메인"
  type="URL"
  required={false}
  description="운영 환경 결제창 서버 도메인입니다."
  example="npg.settlebank.co.kr"
/>

<ParameterCard
  name="운영 API 서버 도메인"
  type="URL"
  required={false}
  description="운영 환경 API 서버 도메인입니다."
  example="gw.settlebank.co.kr"
  note="취소 및 기타 API 서비스용 도메인입니다."
/>

<ParameterCard
  name="운영 결제창 IP"
  type="IP Address"
  required={false}
  description="운영 환경 결제창 서버 IP 주소입니다. Primary/Secondary 구성되어 있습니다."
  example="14.34.14.25 (Primary), 61.252.169.58 (Secondary)"
  note="IDC 센터 이중화 구성으로 GLB 시스템 운영됩니다."
/>

<ParameterCard
  name="운영 API 서버 IP"
  type="IP Address"
  required={false}
  description="운영 환경 API 서버 IP 주소입니다."
  example="14.34.14.21 (Primary), 61.252.169.53 (Secondary)"
  note="취소 및 기타 API 서비스용 IP입니다."
/>

### 테스트용 인증 정보

**주의: 다음 정보는 테스트 전용입니다. 운영 환경에서는 절대 사용하지 마세요!**

<ParameterCard
  name="테스트용 암호화키"
  type="string(32)"
  required={true}
  description="개인정보 및 중요정보 암호화에 사용되는 테스트용 공용 키입니다."
  example="pgSettle30y739r82jtd709yOfZ2yK5K"
  note="AES-256/ECB/PKCS5Padding 알고리즘 + Base64 인코딩을 사용합니다."
/>

<ParameterCard
  name="테스트용 해시키"
  type="string(21)"
  required={true}
  description="위변조 방지를 위한 해시 생성에 사용되는 테스트용 인증 키입니다."
  example="ST1009281328226982205"
  note="SHA-256 알고리즘 + Hex 인코딩(소문자)을 사용하여 해시를 생성합니다."
/>

## 표준 결제창(UI) 연동

가장 일반적인 연동 방식으로, 헥토파이낸셜에서 제공하는 결제창을 사용하는 방법입니다.

### 빠른 시작 (5분 연동)

```js
<!-- 1. 헥토파이낸셜 JavaScript SDK 로드 -->
<script src="https://tbnpg.settlebank.co.kr/resources/js/v1/SettlePG_v1.2.js"></script>

<script>
// 2. 결제 요청
SETTLE_PG.pay({
    env: "https://tbnpg.settlebank.co.kr", // 테스트 환경
    mchtId: "nxca_jt_il",                   // 상점 ID
    method: "card",                         // 결제수단
    trdDt: "20231215",                      // 거래일자
    trdTm: "143022",                        // 거래시간
    mchtTrdNo: "ORDER20231215143022",       // 주문번호
    mchtName: "테스트상점",
    pmtPrdtNm: "테스트상품",
    trdAmt: "1000",                         // 결제금액
    notiUrl: "https://yoursite.com/notify", // 결과통보 URL
    nextUrl: "https://yoursite.com/success",// 성공페이지 URL
    cancUrl: "https://yoursite.com/cancel", // 취소페이지 URL
    pktHash: "생성된해시값",                 // 보안 해시
    ui: {
        type: "popup",
        width: "430",
        height: "660"
    }
}, function(response) {
    // 3. 결제 결과 처리
    console.log(response);
});
</script>
```

### 연동 프로세스

<div className="bg-gray-50 p-6 rounded-xl my-8">
  <div className="flex items-center justify-between">
    <div className="flex flex-col items-center text-center">
      <div className="w-12 h-12 bg-hecto-500 rounded-full flex items-center justify-center text-white font-bold text-lg mb-2">1</div>
      <span className="text-sm font-medium text-gray-700">결제 요청</span>
      <span className="text-xs text-gray-500">가맹점→PG</span>
    </div>
    <div className="flex-1 h-0.5 bg-hecto-200 mx-4"></div>
    <div className="flex flex-col items-center text-center">
      <div className="w-12 h-12 bg-hecto-500 rounded-full flex items-center justify-center text-white font-bold text-lg mb-2">2</div>
      <span className="text-sm font-medium text-gray-700">결제창 표시</span>
      <span className="text-xs text-gray-500">PG→고객</span>
    </div>
    <div className="flex-1 h-0.5 bg-hecto-200 mx-4"></div>
    <div className="flex flex-col items-center text-center">
      <div className="w-12 h-12 bg-hecto-500 rounded-full flex items-center justify-center text-white font-bold text-lg mb-2">3</div>
      <span className="text-sm font-medium text-gray-700">정보 입력</span>
      <span className="text-xs text-gray-500">고객 결제</span>
    </div>
    <div className="flex-1 h-0.5 bg-hecto-200 mx-4"></div>
    <div className="flex flex-col items-center text-center">
      <div className="w-12 h-12 bg-hecto-500 rounded-full flex items-center justify-center text-white font-bold text-lg mb-2">4</div>
      <span className="text-sm font-medium text-gray-700">승인 처리</span>
      <span className="text-xs text-gray-500">카드사 승인</span>
    </div>
    <div className="flex-1 h-0.5 bg-hecto-200 mx-4"></div>
    <div className="flex flex-col items-center text-center">
      <div className="w-12 h-12 bg-hecto-500 rounded-full flex items-center justify-center text-white font-bold text-lg mb-2">5</div>
      <span className="text-sm font-medium text-gray-700">결과 통보</span>
      <span className="text-xs text-gray-500">PG→가맹점</span>
    </div>
  </div>
</div>

### 중요 주의사항

<div className="bg-red-50 border-l-4 border-red-400 p-4 my-6">
  <div className="flex">
    <div className="flex-shrink-0">
      <span className="text-red-400 text-lg">⚠️</span>
    </div>
    <div className="ml-3">
      <h4 className="text-red-800 font-medium">필수 확인 사항</h4>
      <ul className="mt-2 text-red-700 text-sm space-y-1">
        <li>• <strong>운영환경 테스트 시 비용 발생</strong> - 테스트는 반드시 테스트베드에서 진행</li>
        <li>• <strong>HTTPS 필수</strong> - HTTP 사용시 브라우저 정책으로 인해 오작동 가능</li>
        <li>• <strong>iframe 사용 금지</strong> - 일부 브라우저에서 정상 작동하지 않음</li>
        <li>• <strong>IE 브라우저 지원 종료</strong> (2022.06.15부터) - Edge 브라우저 사용 권장</li>
      </ul>
    </div>
  </div>
</div>

### URL 파라미터 이해하기

**핵심 URL 3종세트:**

<div className="grid grid-cols-1 md:grid-cols-3 gap-4 my-6">
  <div className="bg-blue-50 border border-hecto-200 p-4 rounded-lg">
    <h4 className="font-semibold text-blue-900 mb-2">🔔 notiUrl</h4>
    <p className="text-sm text-blue-800">Server-to-Server 결과 통보</p>
    <p className="text-xs text-blue-600 mt-2">💡 실제 DB 처리는 여기서!</p>
  </div>
  
  <div className="bg-green-50 border border-hecto-200 p-4 rounded-lg">
    <h4 className="font-semibold text-green-900 mb-2">✅ nextUrl</h4>
    <p className="text-sm text-green-800">결제 완료 후 고객 화면</p>
    <p className="text-xs text-green-600 mt-2">💡 화면 표시용으로만 사용</p>
  </div>
  
  <div className="bg-hecto-50 border border-hecto-200 p-4 rounded-lg">
    <h4 className="font-semibold text-hecto-900 mb-2">❌ cancUrl</h4>
    <p className="text-sm text-hecto-800">결제 취소 시 이동 화면</p>
    <p className="text-xs text-hecto-600 mt-2">💡 고객이 강제 종료시</p>
  </div>
</div>

---

## API 서버 연동 (Non-UI)

결제창 없이 서버에서 직접 결제를 처리하는 방식입니다.

### API 특징

- **Server-to-Server** 통신
- **JSON** 기반 데이터 교환
- **실시간** 결제 처리
- **높은 보안성**



### 요청/응답 헤더

```http
Content-type: application/json; charset=UTF-8
```

### API 연동 예시

```javascript
// API 요청 예시
const paymentRequest = {
    params: {
        mchtId: "nx_mid_il",
        ver: "0A19",
        mchtTrdNo: "ORDER20231215143022",
        trdDt: "20231215",
        trdTm: "143022"
    },
    data: {
        pktHash: "생성된해시값",
        method: "CA",
        trdAmt: "1000",
        pmtPrdtNm: "테스트상품",
        mchtCustNm: "홍길동",
        notiUrl: "https://yoursite.com/notify"
    }
};

// 서버로 전송
fetch('https://tbgw.settlebank.co.kr/spay/APICard.do', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json; charset=UTF-8'
    },
    body: JSON.stringify(paymentRequest)
})
.then(response => response.json())
.then(data => {
    console.log('결제 결과:', data);
});
```

---

### 노티(Notification) 서버

결제 결과를 실시간으로 통보받기 위한 서버 설정이 필요합니다.

<div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 my-6">
  <div className="flex">
    <div className="flex-shrink-0">
      <span className="text-yellow-400 text-lg">💡</span>
    </div>
    <div className="ml-3">
      <h4 className="text-yellow-800 font-medium">노티 서버 주의사항</h4>
      <div className="mt-2 text-yellow-700 text-sm">
        notiUrl로 전송되는 결과 데이터는 <strong>반드시 해시 검증</strong>을 거쳐야 합니다. 
        검증이 완료된 후에만 실제 서비스를 제공하세요.
      </div>
    </div>
  </div>
</div>

---

**중요 사항:**
- 운영 환경 이행 시 **헥토파이낸셜에서 별도 제공하는 고유 키**를 사용해야 합니다
- 테스트용 키를 운영 환경에 사용하면 **보안 문제**가 발생할 수 있습니다

---

## 중요 정보 보안

### 개인정보 암복호화

#### AES 암호화 방식

**알고리즘**: AES-256/ECB/PKCS5Padding + **Base64 인코딩**

```javascript
// AES-256-ECB 암호화 예시 (Base64 인코딩)
const CryptoJS = require('crypto-js');

function encryptAES(plainText, secretKey) {
    const key = CryptoJS.enc.Utf8.parse(secretKey);
    const encrypted = CryptoJS.AES.encrypt(plainText, key, {
        mode: CryptoJS.mode.ECB,
        padding: CryptoJS.pad.Pkcs5
    });
    return encrypted.toString(); // Base64 인코딩된 결과 반환
}

// 사용 예시
const encryptedAmount = encryptAES("1000", "pgSettle30y739r82jtd709yOfZ2yK5K");
// 결과: "AntV/eDpxIaKF0hJiePDKA==" (Base64 인코딩)
```

### 해시 검증 알고리즘

**알고리즘**: SHA-256 + **Hex 인코딩 (소문자)**

```javascript
const crypto = require('crypto');

function generateHash(data) {
    return crypto.createHash('sha256').update(data, 'utf8').digest('hex');
}

// 해시 생성 예시 (신용카드 결제)
const hashData = mchtId + method + mchtTrdNo + trdDt + trdTm + trdAmt + hashKey;
const pktHash = generateHash(hashData);
// 결과: "f395b6725a9a18f2563ce34f8bc76698051d27c05e5ba815f463f00429061c0c" (Hex 소문자)
```

### 개인정보 암호키

암호화에 사용되는 키는 **헥토파이낸셜에서 별도 제공**합니다.
- 키 관리는 **보안이 중요**합니다
- 소스코드에 하드코딩하지 마세요
- 환경변수나 보안 저장소를 이용하세요

### 해시 인증키

위변조 방지를 위한 해시 인증키도 **헥토파이낸셜에서 별도 제공**합니다.

---

## 다음 단계

<NextSteps 
  title="축하합니다! 기본 연동 방법을 익혔습니다. 이제 구체적인 결제 수단별 연동을 시작해보세요:"
/>

### 추가 리소스

- [📚 인터랙티브 API 문서](/api-docs) - 모든 API를 한눈에 보고 테스트해보세요
- [샘플 코드 다운로드](https://develop.sbsvc.online/21/bbsList.do?tx=R&articleSeq=149)
- [자주 묻는 질문](https://develop.sbsvc.online/3/bbsList.do)
- [고객센터 문의](mailto:support@hectofinancial.com)

<DocumentFooter 
  title="더 자세한 내용이나 기술 지원이 필요하시나요?"
  primaryButton={{
    text: "📧 이메일 문의",
    href: "mailto:support@hectofinancial.com"
  }}
  secondaryButton={{
    text: "📞 전화 문의",
    href: "tel:1588-0000"
  }}
/>
