
# ⚡ 간편 결제

페이코, 카카오페이, 네이버페이, 삼성페이 등 다양한 간편결제 서비스를 통한 결제 솔루션입니다. 고객이 선호하는 간편결제 방식으로 빠르고 편리한 결제가 가능합니다.

## 📖 개요

### 🎯 주요 특징

<FeatureGrid features={[
  {
    icon: "⚡",
    title: "빠른 결제",
    description: "간편한 인증으로 빠른 결제 완료, 복잡한 카드 정보 입력 불필요",
    bgColor: "from-hecto-50 to-hecto-100",
    borderColor: "border-hecto-200",
    iconBgColor: "bg-hecto-400"
  },
  {
    icon: "🏢",
    title: "다양한 브랜드",
    description: "페이코, 카카오페이, 네이버페이, 삼성페이 등 주요 간편결제 지원",
    bgColor: "from-hecto-50 to-hecto-100",
    borderColor: "border-hecto-200",
    iconBgColor: "bg-hecto-400"
  },
  {
    icon: "💳",
    title: "복합 결제",
    description: "포인트, 쿠폰, 카드 등 다양한 결제 수단을 조합하여 사용",
    bgColor: "from-hecto-50 to-hecto-100",
    borderColor: "border-hecto-200",
    iconBgColor: "bg-hecto-400"
  },
  {
    icon: "🔄",
    title: "인증/승인 분리",
    description: "하이브리드 방식으로 인증과 승인을 분리한 유연한 결제 프로세스",
    bgColor: "from-hecto-50 to-hecto-100",
    borderColor: "border-hecto-200",
    iconBgColor: "bg-hecto-500"
  }
]} />

### 🏢 지원 간편결제 서비스

| 서비스 | 코드 | 특징 | 주요 기능 |
|--------|------|------|-----------|
| **페이코(PAYCO)** | `PAC` | NHN 간편결제 서비스 | 포인트, 쿠폰, 카드 복합결제 |
| **카카오페이** | `KKP` | 카카오 간편결제 서비스 | 카카오머니, 카드결제 |
| **네이버페이** | `NVP` | 네이버 간편결제 서비스 | 포인트, 카드 결제, 현금영수증 |
| **삼성페이** | `SPY` | 삼성 간편결제 서비스 | NFC, MST 기술 활용 |

---

## ⚡ 빠른 시작

### 1️⃣ 페이코 간편결제

```html
<!-- 헥토파이낸셜 SDK 로드 -->
<script src="https://tbnpg.settlebank.co.kr/resources/js/v1/SettlePG_v1.2.js"></script>

<script>
// 페이코 간편결제 요청
SETTLE_PG.pay({
    env: "https://tbnpg.settlebank.co.kr",
    mchtId: "hecto_test",              // 페이코 테스트 상점 ID
    method: "corp",                    // 간편결제
    corpPayCode: "PAC",                // 페이코 코드
    trdDt: "20231215",                 // 거래일자
    trdTm: "143022",                   // 거래시간
    mchtTrdNo: "PAYCO20231215143022",  // 주문번호
    mchtName: "테스트상점",
    pmtPrdtNm: "테스트상품",
    trdAmt: "5000",                    // 5,000원
    taxTypeCd: "N",                    // 과세
    notiUrl: "https://yoursite.com/payco/notify",
    nextUrl: "https://yoursite.com/payco/success",
    cancUrl: "https://yoursite.com/payco/cancel",
    pktHash: "생성된해시값",           // SHA256 해시
    ui: {
        type: "popup",
        width: "430",
        height: "660"
    }
}, function(response) {
    if (response.outStatCd === "0021") {
        // 결제 성공
        console.log("페이코 결제 성공:", response);
        alert(`결제 완료!\n거래번호: ${response.trdNo}\n승인시간: ${response.authDt}`);
    } else if (response.outStatCd === "0061") {
        // 인증 성공 (하이브리드 방식)
        console.log("인증 성공, 승인 API 호출 필요:", response);
        // 별도 승인 API 호출
        callPaycoApprovalAPI(response.trdNo);
    } else {
        // 결제 실패
        console.log("페이코 결제 실패:", response.outRsltMsg);
        alert("결제가 실패했습니다: " + response.outRsltMsg);
    }
});
</script>
```

### 2️⃣ 다양한 간편결제 선택

```javascript
// 간편결제 브랜드별 결제 함수
function payWithSimplePayment(serviceType, amount, productName) {
    const simplePaymentConfig = {
        'payco': {
            corpPayCode: 'PAC',
            name: '페이코',
            mchtId: 'hecto_test'
        },
        'kakaopay': {
            corpPayCode: 'KKP', 
            name: '카카오페이',
            mchtId: 'hecto_test'
        },
        'naverpay': {
            corpPayCode: 'NVP',
            name: '네이버페이', 
            mchtId: 'hecto_test'
        }
    };

    const config = simplePaymentConfig[serviceType];
    if (!config) {
        alert('지원하지 않는 간편결제 서비스입니다.');
        return;
    }

    SETTLE_PG.pay({
        env: "https://tbnpg.settlebank.co.kr",
        mchtId: config.mchtId,
        method: "corp",
        corpPayCode: config.corpPayCode,
        trdDt: getCurrentDate(),
        trdTm: getCurrentTime(),
        mchtTrdNo: generateOrderNo(),
        mchtName: "테스트상점",
        pmtPrdtNm: productName,
        trdAmt: amount.toString(),
        taxTypeCd: "N",
        notiUrl: `https://yoursite.com/${serviceType}/notify`,
        nextUrl: `https://yoursite.com/${serviceType}/success`,
        cancUrl: `https://yoursite.com/${serviceType}/cancel`,
        pktHash: generateSimplePaymentHash({
            mchtId: config.mchtId,
            method: "corp",
            mchtTrdNo: generateOrderNo(),
            trdDt: getCurrentDate(),
            trdTm: getCurrentTime(),
            trdAmt: amount.toString()
        })
    }, function(response) {
        if (response.outStatCd === "0021") {
            alert(`${config.name} 결제 완료!`);
        } else {
            alert(`${config.name} 결제 실패: ${response.outRsltMsg}`);
        }
    });
}

// 사용 예시
payWithSimplePayment('payco', 5000, '테스트 상품');
payWithSimplePayment('kakaopay', 10000, '프리미엄 서비스');
payWithSimplePayment('naverpay', 15000, '멤버십 구독');
```

---

## 🏗️ 구현 가이드

### 1️⃣ 페이코 간편결제 (UI)

#### 📡 API 엔드포인트

| 환경 | URL |
|------|-----|
| **테스트** | `https://tbnpg.settlebank.co.kr/corp/main.do` |
| **운영** | `https://npg.settlebank.co.kr/corp/main.do` |

#### 📋 요청 파라미터

<DocParameterCard
  name="mchtId"
  type="string(10)"
  required={true}
  description="헥토파이낸셜에서 부여하는 고유 상점아이디입니다."
  example="hecto_test"
  values={[
    "hecto_test: 페이코 간편결제",
    "nx_mid_hd: 인증/승인 분리형"
  ]}
  note="간편결제 서비스별로 다른 상점ID가 필요할 수 있습니다."
/>

<DocParameterCard
  name="method"
  type="string(20)"
  required={true}
  description="PG 서비스에 해당하는 결제 구분 코드입니다."
  example="corp"
  note="간편결제의 경우 항상 'corp' 고정값을 사용합니다."
/>

<DocParameterCard
  name="corpPayCode"
  type="string(3)"
  required={true}
  description="간편결제 서비스를 구분하는 코드입니다."
  values={[
    "PAC: 페이코",
    "KKP: 카카오페이",
    "NVP: 네이버페이",
    "SPY: 삼성페이"
  ]}
  note="💡 사용하고자 하는 간편결제 서비스의 코드를 정확히 입력해야 합니다."
/>

<DocParameterCard
  name="trdDt"
  type="string(8)"
  required={true}
  description="거래 요청 일자입니다. yyyyMMdd 형식으로 전달합니다."
  example="20231215"
/>

<DocParameterCard
  name="trdTm"
  type="string(6)"
  required={true}
  description="거래 요청 시간입니다. HH24MISS 형식으로 전달합니다."
  example="143022"
/>

<DocParameterCard
  name="mchtTrdNo"
  type="string(100)"
  required={true}
  description="상점에서 생성하는 고유 주문번호입니다. 간편결제 추적과 관리에 사용됩니다."
  example="PAYCO20231215143022"
  note="⚠️ 한글은 사용할 수 없으며, 영문, 숫자, 일부 특수문자만 사용 가능합니다."
/>

<DocParameterCard
  name="mchtName"
  type="string(100)"
  required={true}
  description="상점의 한글명입니다."
  example="헥토파이낸셜"
/>

<DocParameterCard
  name="pmtPrdtNm"
  type="string(128)"
  required={true}
  description="결제할 상품의 이름입니다. 간편결제 화면에 표시됩니다."
  example="테스트상품"
/>

<DocParameterCard
  name="trdAmt"
  type="number(12)"
  required={true}
  description="간편결제로 결제할 금액입니다."
  example="5000"
  note="⚠️ 이 필드는 AES 암호화가 필요합니다."
/>

<DocParameterCard
  name="taxTypeCd"
  type="string(1)"
  required={false}
  description="세금 유형을 설정합니다."
  values={[
    "N: 과세 (기본값)",
    "Y: 면세",
    "G: 복합과세"
  ]}
  note="💡 공백일 경우 상점 설정에 따릅니다. 과세 유형별로 결제 수단이 상이할 수 있습니다."
/>

<DocParameterCard
  name="taxAmt"
  type="number(12)"
  required={false}
  description="과세금액입니다. 복합과세일 경우 필수입니다."
  example="909"
  note="⚠️ 이 필드는 AES 암호화가 필요합니다."
/>

<DocParameterCard
  name="vatAmt"
  type="number(12)"
  required={false}
  description="부가세금액입니다. 복합과세일 경우 필수입니다."
  example="91"
  note="⚠️ 이 필드는 AES 암호화가 필요합니다."
/>

<DocParameterCard
  name="taxFreeAmt"
  type="number(12)"
  required={false}
  description="면세금액입니다. 복합과세일 경우 필수입니다."
  example="0"
  note="⚠️ 이 필드는 AES 암호화가 필요합니다."
/>

<DocParameterCard
  name="notiUrl"
  type="string(250)"
  required={true}
  description="결제 완료 후 결과를 전달받을 서버 URL입니다. Server-to-Server 방식으로 결제 결과를 수신합니다."
  example="https://yoursite.com/payment/simple/notification"
  note="💡 실제 결제 처리는 반드시 이 URL에서 처리하세요."
/>

<DocParameterCard
  name="nextUrl"
  type="string(250)"
  required={true}
  description="결제 완료 후 고객에게 보여줄 화면 URL입니다."
  example="https://yoursite.com/payment/simple/success"
/>

<DocParameterCard
  name="cancUrl"
  type="string(250)"
  required={true}
  description="고객이 간편결제를 취소했을 때 이동할 페이지 URL입니다."
  example="https://yoursite.com/payment/cancel"
/>

<DocParameterCard
  name="mchtParam"
  type="string(4000)"
  required={false}
  description="상점에서 추가로 전달하고 싶은 정보를 담는 예약 필드입니다. 결제 완료 후 그대로 반환됩니다."
  example="serviceType=payco&userId=12345&eventCode=WINTER2023"
/>

<DocParameterCard
  name="mchtCustId"
  type="string(50)"
  required={false}
  description="상점에서 관리하는 고유 고객 아이디입니다."
  example="CUST_20231215_001"
  note="⚠️ 이 필드는 AES 암호화가 필요합니다."
/>

<DocParameterCard
  name="appScheme"
  type="string(100)"
  required={false}
  description="모바일 앱에서 결제 후 원래 앱으로 돌아가기 위한 스키마입니다."
  example="PAYAPPNAME"
  note="💡 자체앱을 구축하는 경우에만 사용합니다."
/>

<DocParameterCard
  name="pktHash"
  type="string(200)"
  required={true}
  description="위변조 방지를 위한 SHA256 해시값입니다. 지정된 순서로 파라미터를 조합하여 생성합니다."
  example="f395b6725a9a18f2563ce34f8bc76698051d27c05e5ba815f463f00429061c0c"
  note="🔒 상점아이디 + 결제수단 + 상점주문번호 + 요청일자 + 요청시간 + 거래금액(평문) + 해시키 순서로 조합"
/>

#### 🔐 해시 생성 예시

```javascript
const crypto = require('crypto');

function generateSimplePaymentHash(params, hashKey) {
    // 해시 생성을 위한 데이터 조합
    const hashData = 
        params.mchtId +         // 상점아이디
        params.method +         // 결제수단 (corp)
        params.mchtTrdNo +      // 상점주문번호
        params.trdDt +          // 요청일자
        params.trdTm +          // 요청시간
        params.trdAmt +         // 거래금액 (평문, 암호화 전)
        hashKey;                // 해시키 (헥토파이낸셜 제공)
    
    // SHA256 해시 생성
    return crypto.createHash('sha256').update(hashData, 'utf8').digest('hex');
}

// 사용 예시
const simplePaymentParams = {
    mchtId: "hecto_test",
    method: "corp",
    mchtTrdNo: "PAYCO20231215143022",
    trdDt: "20231215",
    trdTm: "143022",
    trdAmt: "5000"  // 암호화 전 원본 금액
};

const hashKey = "your-hash-key-from-hecto"; // 헥토파이낸셜에서 제공
const pktHash = generateSimplePaymentHash(simplePaymentParams, hashKey);
```

### 2️⃣ 응답 처리

#### 📨 결제 성공 응답

```javascript
{
    "outStatCd": "0021",               // 성공 코드
    "outRsltCd": "0000",               // 결과 코드
    "outRsltMsg": "정상처리",           // 결과 메시지
    "method": "corp",                  // 결제수단
    "mchtTrdNo": "PAYCO20231215143022", // 상점주문번호
    "trdNo": "STFP_PGCAnxca_jt_il0231215143022M1494620", // 헥토 거래번호
    "trdAmt": "5000",                  // 거래금액
    "authDt": "20231215143045"         // 승인일시
}
```

#### 🔐 하이브리드 인증 성공 응답

```javascript
{
    "outStatCd": "0061",               // 인증 성공 코드
    "outRsltCd": "0000",               // 결과 코드
    "outRsltMsg": "인증 성공",          // 결과 메시지
    "method": "corp",
    "mchtTrdNo": "PAYCO20231215143022",
    "trdNo": "STFP_PGCAnx_mid_hd0231215143022M1234567", // 인증 거래번호
    "trdAmt": "5000"
    // 별도 승인 API 호출 필요
}
```

#### ❌ 결제 실패 응답

```javascript
{
    "outStatCd": "0031",               // 실패 코드
    "outRsltCd": "1009",               // 에러 코드
    "outRsltMsg": "결제 요청 정보 누락 (상품명)", // 에러 메시지
    "method": "corp",
    "mchtTrdNo": "PAYCO20231215143022"
}
```

### 3️⃣ 결제 완료 노티(NOTI) 처리

간편결제가 완료되면 `notiUrl`로 결과가 전송됩니다.

```javascript
// Node.js Express 예시
app.post('/payment/simple/notification', (req, res) => {
    const {
        outStatCd,
        trdNo,
        method,
        bizType,
        mchtTrdNo,
        trdAmt,
        trdDtm,
        ezpDivCd,      // 간편결제사 구분코드
        cardCd,        // 카드사코드
        cardNm,        // 카드명
        pntAmt,        // 포인트 금액
        cardAmt,       // 신용카드 금액
        coupAmt,       // 쿠폰 금액
        kkmAmt,        // 카카오머니 금액
        csrcIssAmt,    // 현금영수증 발행대상금액
        csrcIssNo,     // 현금영수증 승인번호
        pktHash
    } = req.body;
    
    // 1. 해시 검증
    const expectedHash = generateSimplePaymentNotiHash(req.body, hashKey);
    if (pktHash !== expectedHash) {
        console.error('해시 검증 실패');
        return res.status(400).send('FAIL');
    }
    
    // 2. 결제 성공 여부 확인
    if (outStatCd === '0021') {
        if (bizType === 'B0') {
            // 일반 승인 (페이코, 카카오페이)
            await updateSimplePaymentStatus(mchtTrdNo, {
                status: 'completed',
                hectoTrdNo: trdNo,
                completedAt: trdDtm,
                serviceProvider: getServiceProviderName(ezpDivCd),
                paymentDetails: {
                    pointAmount: pntAmt,
                    cardAmount: cardAmt,
                    couponAmount: coupAmt,
                    kakaoMoneyAmount: kkmAmt,
                    cardInfo: cardCd ? { code: cardCd, name: cardNm } : null,
                    cashReceiptAmount: csrcIssAmt,
                    cashReceiptNumber: csrcIssNo
                }
            });
        } else if (bizType === 'B1') {
            // 네이버페이 신용카드 결제
            await updateSimplePaymentStatus(mchtTrdNo, {
                status: 'completed',
                hectoTrdNo: trdNo,
                completedAt: trdDtm,
                serviceProvider: 'NaverPay',
                paymentMethod: 'card',
                cardInfo: { code: cardCd, name: cardNm }
            });
        }
        
        // 고객에게 결제 완료 알림 발송
        await sendSimplePaymentNotification(mchtTrdNo);
        
        // 성공 응답
        res.send('OK');
    } else if (bizType === 'C0') {
        // 취소 처리
        await updateSimplePaymentStatus(mchtTrdNo, {
            status: 'cancelled',
            cancelledAt: trdDtm
        });
        
        res.send('OK');
    } else {
        // 기타 상태 처리
        console.log('간편결제 상태:', outStatCd, req.body.outRsltMsg);
        res.send('OK');
    }
});

// 간편결제사 구분코드 매핑
function getServiceProviderName(ezpDivCd) {
    const providerMap = {
        'PAC': 'PAYCO',
        'KKP': 'KakaoPay',
        'NVP': 'NaverPay',
        'SPY': 'SamsungPay'
    };
    return providerMap[ezpDivCd] || ezpDivCd;
}

// 간편결제 노티 해시 생성 함수
function generateSimplePaymentNotiHash(notiData, hashKey) {
    const hashData = 
        notiData.outStatCd +    // 거래상태코드
        notiData.trdDtm.substring(0, 8) +  // 거래일자 (YYYYMMDD)
        notiData.trdDtm.substring(8, 14) + // 거래시간 (HHMMSS)
        notiData.mchtId +       // 상점아이디
        notiData.mchtTrdNo +    // 상점주문번호
        notiData.trdAmt +       // 거래금액
        hashKey;                // 해시키
    
    return crypto.createHash('sha256').update(hashData, 'utf8').digest('hex');
}
```

---

## 🔄 고급 기능

### 1️⃣ 하이브리드 API (인증/승인 분리)

페이코의 경우 인증과 승인을 분리한 하이브리드 방식을 지원합니다.

#### 📡 승인 API 엔드포인트

| 환경 | URL |
|------|-----|
| **테스트** | `https://tbgw.settlebank.co.kr/spay/APITrdPayco.do` |
| **운영** | `https://gw.settlebank.co.kr/spay/APITrdPayco.do` |

#### 💻 승인 API 호출

```javascript
// 페이코 하이브리드 승인 API
async function callPaycoApprovalAPI(authTrdNo, amount) {
    const approvalRequest = {
        params: {
            mchtId: "nx_mid_hd",
            ver: "0A19",
            method: "PZ",
            bizType: "B2",
            encCd: "23",
            mchtTrdNo: "APPROVAL20231215143022",
            trdDt: "20231215",
            trdTm: "143022"
        },
        data: {
            pktHash: "생성된해시값",
            authTrdNo: authTrdNo,        // 인증 거래번호
            trdAmt: amount
        }
    };

    try {
        const response = await fetch('https://tbgw.settlebank.co.kr/spay/APITrdPayco.do', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json; charset=UTF-8'
            },
            body: JSON.stringify(approvalRequest)
        });
        
        const result = await response.json();
        
        if (result.outStatCd === '0021') {
            console.log('페이코 승인 성공:', result);
            return result;
        } else {
            console.error('페이코 승인 실패:', result.outRsltMsg);
            throw new Error(result.outRsltMsg);
        }
    } catch (error) {
        console.error('페이코 승인 API 호출 실패:', error);
        throw error;
    }
}
```

### 2️⃣ 간편결제 취소

각 간편결제 서비스별 취소 API입니다.

#### 💻 페이코 취소 요청

```javascript
const cancelPaycoRequest = {
    params: {
        mchtId: "hecto_test",
        ver: "0A19",
        method: "PZ",
        bizType: "C0",
        encCd: "23",
        mchtTrdNo: "CANCEL20231215143022",
        trdDt: "20231215",
        trdTm: "143022"
    },
    data: {
        pktHash: "생성된해시값",
        orgTrdNo: "STFP_PGCAnxca_jt_il0231215143022M1494620", // 원거래번호
        crcCd: "KRW",
        cnclOrd: "001",
        taxTypeCd: "N",
        cnclAmt: "5000",                 // 취소금액
        cnclRsn: "고객 요청"             // 취소사유
    }
};
```

#### 💻 네이버페이 취소 요청

```javascript
const cancelNaverPayRequest = {
    params: {
        mchtId: "hecto_test",
        ver: "0A19",
        method: "PZ",
        bizType: "C0",
        encCd: "23",
        mchtTrdNo: "CANCEL20231215143022",
        trdDt: "20231215",
        trdTm: "143022"
    },
    data: {
        pktHash: "생성된해시값",
        orgTrdNo: "원거래번호",
        crcCd: "KRW",
        cnclOrd: "001",
        taxTypeCd: "N",
        cnclAmt: "5000",
        taxAmt: "4545",                  // 과세금액
        vatAmt: "455",                   // 부가세금액
        taxFreeAmt: "0",                 // 비과세금액
        svcAmt: "0",                     // 봉사료
        cnclRsn: "고객 요청"
    }
};
```

### 3️⃣ 복합결제 처리

간편결제에서는 포인트, 쿠폰, 카드 등을 조합한 복합결제가 가능합니다.

```javascript
// 복합결제 결과 처리
function handleComplexPayment(notiData) {
    const paymentBreakdown = {
        totalAmount: parseInt(notiData.trdAmt),
        pointAmount: parseInt(notiData.pntAmt || 0),
        cardAmount: parseInt(notiData.cardAmt || 0),
        couponAmount: parseInt(notiData.coupAmt || 0),
        kakaoMoneyAmount: parseInt(notiData.kkmAmt || 0)
    };
    
    console.log('복합결제 내역:', paymentBreakdown);
    
    // 각 결제 수단별 처리
    if (paymentBreakdown.pointAmount > 0) {
        console.log(`포인트 사용: ${paymentBreakdown.pointAmount}원`);
        // 포인트 사용 내역 기록
    }
    
    if (paymentBreakdown.couponAmount > 0) {
        console.log(`쿠폰 사용: ${paymentBreakdown.couponAmount}원`);
        // 쿠폰 사용 내역 기록
    }
    
    if (paymentBreakdown.cardAmount > 0) {
        console.log(`카드 결제: ${paymentBreakdown.cardAmount}원`);
        // 카드 결제 내역 기록
    }
    
    // 현금영수증 발행 확인
    if (notiData.csrcIssAmt && notiData.csrcIssNo) {
        console.log(`현금영수증 발행: ${notiData.csrcIssAmt}원, 승인번호: ${notiData.csrcIssNo}`);
    }
    
    return paymentBreakdown;
}
```

---

## 🧪 테스트 가이드

### 🔧 테스트 환경 설정

**테스트 상점 정보:**
- **페이코**: `hecto_test`
- **카카오페이**: `hecto_test`
- **네이버페이**: `hecto_test`
- **환경**: `https://tbnpg.settlebank.co.kr`

### 💳 페이코 테스트 카드 정보

원본 문서에 명시된 페이코 개발계 테스트 카드:

| 카드사 | 카드번호 | 유효기간(MM/YY) | CVC | 비밀번호 |
|--------|----------|-----------------|-----|----------|
| **하나카드** | 9440-81**-****-**** | 12/25 | *** | **** |
| | 4570-47**-****-**** | | | |
| **신한카드** | 5107-3767-1104-**** | | | |
| | 9410-84**-****-**** | | | |
| **비씨카드** | 4906-****-****-**** | | | |
| | 5377-03**-****-**** | | | |
| **현대카드** | 9490-1907-****-**** | | | |
| | 3646-83**-****-**** | | | |
| **우리(BC)카드** | 6253-20**-****-**** | | | |
| | 9420-22**-****-**** | | | |
| **국민카드** | 4673-09**-****-**** | | | |
| | 4579-92**-****-**** | | | |
| **농협카드** | 4988-19**-****-**** | | | |
| **신한카드** | 9710-10**-****-**** | | | |
| **우리독자카드** | 4693-69**-****-**** | | | |

> **＊ 표시는 임의의 값을 넣어주시면 됩니다.**

### 📱 페이코 개발 앱 설치

페이코 테스트를 위해서는 개발용 앱 설치가 필요합니다:

1. **다운로드**: https://devcenter.payco.com/support/app?id=220401041
2. **iOS 설정**: 설정 > 일반 > 기기관리 > 'NHN'을(를) 신뢰함 선택
3. **기존 앱 삭제**: 리얼 PAYCO 앱이 설치되어 있으면 삭제 후 설치

### 🎯 테스트 시나리오

<TestScenario 
  successItems={[
    "각 브랜드별 정상 결제",
    "하이브리드 인증 → 승인",
    "복합결제 (포인트+카드)",
    "전체 취소",
    "부분 취소"
  ]}
  failureItems={[
    "잘못된 간편결제 코드",
    "간편결제 앱 미설치",
    "결제 한도 초과",
    "인증 실패",
    "해시값 불일치"
  ]}
/>

---

## ❌ 에러 처리

### 🚨 주요 에러 코드

| 코드 | 메시지 | 원인 | 해결방법 |
|------|--------|------|----------|
| `1009` | 결제 요청 정보 누락 (상품명) | 필수 파라미터 누락 | 필수 파라미터 확인 |
| `1901` | 해쉬값 불일치 오류 | 해시 생성 오류 | 해시 생성 로직 점검 |
| `1902` | 암호화 항목 미처리 오류 | 암호화 필드 미처리 | AES 암호화 적용 |
| `SP01` | 간편결제 앱 미설치 | 앱이 설치되지 않음 | 앱 설치 안내 |
| `SP02` | 간편결제 인증 실패 | 사용자 인증 실패 | 재인증 요청 |
| `SP03` | 결제 한도 초과 | 일일/월간 한도 초과 | 한도 확인 안내 |

### 🔧 에러 해결 가이드

<div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 my-6">
  <div className="flex">
    <div className="flex-shrink-0">
      <span className="text-yellow-400 text-lg">💡</span>
    </div>
    <div className="ml-3">
      <h4 className="text-yellow-800 font-medium">일반적인 문제 해결</h4>
      <ul className="mt-2 text-yellow-700 text-sm space-y-1">
        <li>• <strong>앱 설치 오류</strong>: 개발용 앱 다운로드 및 신뢰 설정</li>
        <li>• <strong>인증 실패</strong>: 간편결제 서비스 로그인 상태 확인</li>
        <li>• <strong>하이브리드 오류</strong>: 인증 거래번호 정확성 확인</li>
        <li>• <strong>복합결제 오류</strong>: 포인트, 쿠폰 잔액 확인</li>
      </ul>
    </div>
  </div>
</div>

---

## 💡 자주 묻는 질문

### Q. 간편결제별로 다른 상점ID가 필요한가요?
A. 기본적으로 동일한 상점ID를 사용하지만, 서비스별로 별도 계약이 필요할 수 있습니다. 헥토파이낸셜에 문의하세요.

### Q. 하이브리드 방식의 장점은 무엇인가요?
A. 인증과 승인을 분리하여 재고 확인, 쿠폰 적용 등의 추가 로직을 인증 후 승인 전에 처리할 수 있습니다.

### Q. 복합결제는 어떻게 처리되나요?
A. 노티에서 포인트, 쿠폰, 카드 등 각 결제 수단별 금액이 개별적으로 전달되므로 이를 분석하여 처리합니다.

### Q. 간편결제 취소 정책은 어떻게 되나요?
A. 각 간편결제 서비스별로 취소 정책이 다르며, 당일 취소와 익일 환불로 구분됩니다.

### Q. 현금영수증은 자동으로 발행되나요?
A. 네이버페이의 경우 자동으로 현금영수증이 발행되며, 발행 금액과 승인번호가 노티로 전달됩니다.

---

## 🚀 다음 단계

간편결제 연동을 완료했다면, 다른 결제 수단도 확인해보세요:

<div className="grid grid-cols-2 md:grid-cols-4 gap-4 my-8">
  <a href="/docs/pg/credit-card" className="block p-4 bg-white border-2 border-hecto-100 hover:border-hecto-300 rounded-xl transition-colors group">
    <div className="text-center">
      <div className="w-12 h-12 bg-hecto-400 rounded-lg flex items-center justify-center mx-auto mb-2 group-hover:bg-hecto-500 transition-colors">
        <span className="text-white text-lg">💳</span>
      </div>
      <span className="text-sm font-medium text-gray-900">신용카드</span>
    </div>
  </a>
  
  <a href="/docs/pg/mobile-payment" className="block p-4 bg-white border-2 border-purple-100 hover:border-purple-300 rounded-xl transition-colors group">
    <div className="text-center">
      <div className="w-12 h-12 bg-hecto-400 rounded-lg flex items-center justify-center mx-auto mb-2 group-hover:bg-purple-600 transition-colors">
        <span className="text-white text-lg">📱</span>
      </div>
      <span className="text-sm font-medium text-gray-900">휴대폰</span>
    </div>
  </a>
  
  <a href="/docs/pg/virtual-account" className="block p-4 bg-white border-2 border-green-100 hover:border-green-300 rounded-xl transition-colors group">
    <div className="text-center">
      <div className="w-12 h-12 bg-hecto-400 rounded-lg flex items-center justify-center mx-auto mb-2 group-hover:bg-green-600 transition-colors">
        <span className="text-white text-lg">💰</span>
      </div>
      <span className="text-sm font-medium text-gray-900">가상계좌</span>
    </div>
  </a>
  
  <a href="/docs/pg/gift-card" className="block p-4 bg-white border-2 border-pink-100 hover:border-pink-300 rounded-xl transition-colors group">
    <div className="text-center">
      <div className="w-12 h-12 bg-pink-500 rounded-lg flex items-center justify-center mx-auto mb-2 group-hover:bg-pink-600 transition-colors">
        <span className="text-white text-lg">🎁</span>
      </div>
      <span className="text-sm font-medium text-gray-900">상품권</span>
    </div>
  </a>
</div>

<DocumentFooter 
  title="간편결제 연동에 대한 추가 문의사항이 있으시나요?"
  primaryButton={{
    text: "📧 기술지원 문의",
    href: "mailto:support@hectofinancial.com"
  }}
  secondaryButton={{
    text: "📚 API 레퍼런스",
    href: "/docs/pg/api-reference"
  }}
/>
