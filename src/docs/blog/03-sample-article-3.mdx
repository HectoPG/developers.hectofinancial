# í—¥í† íŒŒì´ë‚¸ì…œ ê²°ê³¼í†µë³´ URL ì„¤ì • ê°€ì´ë“œ

Server-to-Server ê²°ê³¼ í†µë³´ë¥¼ ìœ„í•œ notiUrl ì„¤ì • ë°©ë²•ì„ ì•Œì•„ë³´ì„¸ìš”.

## ê²°ê³¼í†µë³´ URLì´ë€?

`notiUrl`ì€ í—¥í† íŒŒì´ë‚¸ì…œ ì„œë²„ì—ì„œ ê·€í•˜ì˜ ì„œë²„ë¡œ ê²°ì œ ê²°ê³¼ë¥¼ ìë™ìœ¼ë¡œ í†µë³´í•˜ëŠ” URLì…ë‹ˆë‹¤. ì‹¤ì œ DB ì²˜ë¦¬ëŠ” ì´ê³³ì—ì„œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.

## notiUrl ì„¤ì •

### ê¸°ë³¸ ì„¤ì •
```javascript
SETTLE_PG.pay({
    env: "https://tbnpg.settlebank.co.kr",
    mchtId: "nxca_jt_il",
    method: "card",
    trdDt: "20231215",
    trdTm: "143022",
    mchtTrdNo: "ORDER20231215143022",
    mchtName: "í…ŒìŠ¤íŠ¸ìƒì ",
    pmtPrdtNm: "í…ŒìŠ¤íŠ¸ìƒí’ˆ",
    trdAmt: "1000",
    notiUrl: "https://yoursite.com/notify", // ê²°ê³¼í†µë³´ URL
    nextUrl: "https://yoursite.com/success",
    cancUrl: "https://yoursite.com/cancel",
    pktHash: "ìƒì„±ëœí•´ì‹œê°’"
}, function(response) {
    console.log(response);
});
```

## ê²°ê³¼í†µë³´ ì²˜ë¦¬

### ğŸ”” notiUrl íŠ¹ì§•
- **Server-to-Server** ê²°ê³¼ í†µë³´
- **ì‹¤ì œ DB ì²˜ë¦¬**ëŠ” ì—¬ê¸°ì„œ!
- ê²°ì œ ì™„ë£Œ í›„ ìë™ìœ¼ë¡œ í˜¸ì¶œë©ë‹ˆë‹¤

### í•´ì‹œ ê²€ì¦ í•„ìˆ˜
```javascript
app.post('/notify', (req, res) => {
    const receivedData = req.body;
    
    // ğŸ”’ ì¤‘ìš”: í•´ì‹œ ê²€ì¦ í•„ìˆ˜
    if (!verifyHash(receivedData)) {
        return res.status(400).send('Invalid hash');
    }
    
    // ê²€ì¦ ì™„ë£Œ í›„ ì‹¤ì œ ì„œë¹„ìŠ¤ ì œê³µ
    processPaymentResult(receivedData);
    
    res.status(200).send('OK');
});
```

## ë³´ì•ˆ ì£¼ì˜ì‚¬í•­

> âš ï¸ **ì¤‘ìš”**: notiUrlë¡œ ì „ì†¡ë˜ëŠ” ê²°ê³¼ ë°ì´í„°ëŠ” **ë°˜ë“œì‹œ í•´ì‹œ ê²€ì¦**ì„ ê±°ì³ì•¼ í•©ë‹ˆë‹¤. ê²€ì¦ì´ ì™„ë£Œëœ í›„ì—ë§Œ ì‹¤ì œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ì„¸ìš”.

### í•´ì‹œ ê²€ì¦ ë°©ë²•
1. ì „ì†¡ë°›ì€ ë°ì´í„°ì˜ í•´ì‹œê°’ í™•ì¸
2. ì˜ˆìƒ í•´ì‹œê°’ê³¼ ë¹„êµ
3. ì¼ì¹˜í•˜ëŠ” ê²½ìš°ì—ë§Œ ê²°ì œ ì²˜ë¦¬ ì§„í–‰

## ì‹¤ì œ êµ¬í˜„ ì˜ˆì‹œ

```javascript
// ê²°ì œ ìš”ì²­ ì‹œ notiUrl í¬í•¨
const paymentData = {
    mchtId: "your_merchant_id",
    mchtTrdNo: "ORDER_" + Date.now(),
    trdAmt: "10000",
    mchtCustNm: "í™ê¸¸ë™",
    notiUrl: "https://yoursite.com/notify"
};

// notiUrl ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ì²˜ë¦¬
app.post('/notify', (req, res) => {
    const paymentResult = req.body;
    
    // 1. í•´ì‹œ ê²€ì¦
    if (verifyPaymentHash(paymentResult)) {
        // 2. ê²°ì œ ê²°ê³¼ ì²˜ë¦¬
        updateOrderStatus(paymentResult);
        
        // 3. ì„±ê³µ ì‘ë‹µ
        res.status(200).send('OK');
    } else {
        // í•´ì‹œ ê²€ì¦ ì‹¤íŒ¨
        res.status(400).send('Invalid request');
    }
});
```

---

**ì‘ì„±ì¼**: 2025-09-05  
**ì¹´í…Œê³ ë¦¬**: ê¸°ìˆ   
**ì½ê¸° ì‹œê°„**: 6ë¶„
