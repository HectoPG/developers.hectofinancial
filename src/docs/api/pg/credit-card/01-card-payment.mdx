export const apiInfo = {
  title: "신용카드 결제 (UI)",
  description: "신용카드 UI 결제 API",
  category: "결제 API",
  path: "/card/main.do",
  method: "POST",
  testUrl: "https://tbnpg.settlebank.co.kr/card/main.do",
  prodUrl: "https://npg.settlebank.co.kr/card/main.do",
  contentType: "application/x-www-form-urlencoded"
};

# 신용카드 결제 (UI)

신용카드 UI 결제는 고객이 결제 화면에서 직접 카드 정보를 입력하여 결제를 진행하는 방식입니다.

## 주의 사항

* 상점아이디 속성에 따라 화면이 분기됩니다.
  * 상점아이디가 일반 인증 결제로 설정되어 있는 경우 카드사 인증창이 나타납니다.
  * 상점아이디가 비인증 또는 구인증으로 설정되어 있는 경우 카드정보 입력창이 나타납니다.
* 신용카드 빌키(billKey)를 내려받고자 하는 경우, 빌키서비스를 별도 신청하셔야 합니다
* 빌키를 발급받은 경우, 해당 빌키로 2회차 결제 API 요청하시면 됩니다.
* ※ 매출전표의 발행금액은 가맹점에서 전송하는 파라미터를 기준으로 표기되니 주의하시기 바랍니다.

## API 정보

- **Method**: `POST`
- **Path**: `/card/main.do`
- **Content-Type**: `application/x-www-form-urlencoded`

## 요청 파라미터

<ApiParameterCard
  name="mchtId"
  type="string(10)"
  required={true}
  description="헥토파이낸셜에서 부여하는 고유 상점아이디입니다."
  example="nxca_jt_il"
  values={[
    "nxca_jt_il: 인증",
    "nxca_jt_bi: 비인증", 
    "nxca_jt_gu: 구인증",
    "nxca_ab_bi: 영문외화 비인증",
    "nxca_ab_il: 영문외화 인증"
  ]}
  inputType="text"
  defaultValue="nxca_jt_il"
  placeholder="상점아이디를 입력하세요"
/>

<ApiParameterCard
  name="method"
  type="string(20)"
  required={true}
  description="PG 서비스에 해당하는 결제 구분 코드입니다."
  example="card"
  note="고정값으로 사용합니다."
  inputType="text"
  defaultValue="card"
  fixed={true}
/>

<ApiParameterCard
  name="trdDt"
  type="string(8)"
  required={true}
  description="요청일자 (yyyyMMdd 형식)입니다."
  example="20231215"
  inputType="text"
  defaultValue="20231215"
  placeholder="YYYYMMDD 형식으로 입력하세요"
/>

<ApiParameterCard
  name="trdTm"
  type="string(6)"
  required={true}
  description="요청시간 (HH24MISS 형식)입니다."
  example="143022"
  inputType="text"
  defaultValue="143022"
  placeholder="HHMMSS 형식으로 입력하세요"
/>

<ApiParameterCard
  name="mchtTrdNo"
  type="string(100)"
  required={true}
  description="상점에서 생성하는 고유 주문번호입니다. 한글은 제외해야 합니다."
  example="ORDER20231215143022"
  inputType="text"
  defaultValue="ORDER20231215143022"
  placeholder="상점주문번호를 입력하세요"
/>

<ApiParameterCard
  name="mchtName"
  type="string(100)"
  required={true}
  description="상점한글명입니다."
  example="헥토파이낸셜"
  inputType="text"
  defaultValue="헥토파이낸셜"
  placeholder="상점한글명을 입력하세요"
/>

<ApiParameterCard
  name="mchtEName"
  type="string(100)"
  required={true}
  description="상점영문명입니다."
  example="Hecto Financial"
  inputType="text"
  defaultValue="Hecto Financial"
  placeholder="상점영문명을 입력하세요"
/>

<ApiParameterCard
  name="pmtPrdtNm"
  type="string(128)"
  required={true}
  description="결제상품명입니다."
  example="테스트상품"
  inputType="text"
  defaultValue="테스트상품"
  placeholder="상품명을 입력하세요"
/>

<ApiParameterCard
  name="trdAmt"
  type="string(12)"
  required={true}
  description="거래금액입니다. USD(달러) 사용시 100을 곱하여 전달합니다."
  example="1000"
  note="KRW: 1000, USD: 100 (ex) $ 1.00 → 100 (USD)"
  inputType="text"
  defaultValue="1000"
  placeholder="거래금액을 입력하세요"
/>

<ApiParameterCard
  name="notiUrl"
  type="string(250)"
  required={true}
  description="결제 후 결과 전달되는 페이지의 URL(Server To Server 연동 URL)입니다."
  example="https://example.com/notiUrl"
  inputType="url"
  defaultValue="https://example.com/notiUrl"
  placeholder="결과처리 URL을 입력하세요"
/>

<ApiParameterCard
  name="nextUrl"
  type="string(250)"
  required={true}
  description="결제 후 결과 전달 및 이동페이지 URL입니다."
  example="https://example.com/nextUrl"
  inputType="url"
  defaultValue="https://example.com/nextUrl"
  placeholder="결과화면 URL을 입력하세요"
/>

<ApiParameterCard
  name="cancUrl"
  type="string(250)"
  required={true}
  description="고객 강제 종료시 결과 전달 및 이동페이지 URL입니다."
  example="https://example.com/cancUrl"
  inputType="url"
  defaultValue="https://example.com/cancUrl"
  placeholder="결제취소 URL을 입력하세요"
/>


<ApiParameterCard
  name="mchtCustNm"
  type="string(30)"
  required={false}
  description="고객명입니다."
  example="홍길동"
  inputType="text"
  defaultValue="홍길동"
  placeholder="고객명을 입력하세요"
/>

<ApiParameterCard
  name="mchtCustId"
  type="string(50)"
  required={false}
  description="상점에서 보내주는 고유 고객아이디 혹은 유니크키입니다."
  example="HongGilDong"
  inputType="text"
  defaultValue="HongGilDong"
  placeholder="고객아이디를 입력하세요"
/>

<ApiParameterCard
  name="email"
  type="string(60)"
  required={false}
  description="이메일 주소입니다."
  example="HongGilDong@example.com"
  inputType="email"
  defaultValue="HongGilDong@example.com"
  placeholder="이메일 주소를 입력하세요"
/>

<ApiParameterCard
  name="mchtParam"
  type="string(4000)"
  required={false}
  description="기타 주문 정보를 입력하는 상점 예약 필드입니다."
  example="name=HongGilDong&age=25"
  inputType="text"
  defaultValue="name=HongGilDong&age=25"
  placeholder="상점예약필드를 입력하세요"
/>

<ApiParameterCard
  name="prdtTerm"
  type="string(14)"
  required={false}
  description="상품제공기간 (yyyyMMddHHmmss 형식)입니다. 값이 없으면 일반결제로 표기됩니다."
  example="20221231235959"
  inputType="text"
  defaultValue="20221231235959"
  placeholder="YYYYMMDDHHMMSS 형식으로 입력하세요"
/>

<ApiParameterCard
  name="taxTypeCd"
  type="string(1)"
  required={false}
  description="면세여부입니다."
  example="N"
  values={[
    "N: 과세",
    "Y: 면세", 
    "G: 복합과세"
  ]}
  inputType="text"
  defaultValue="N"
  placeholder="면세여부를 입력하세요"
/>

<ApiParameterCard
  name="taxAmt"
  type="string(12)"
  required={false}
  description="과세금액입니다. 복합과세일 경우 필수입니다."
  example="909"
  inputType="text"
  defaultValue="909"
  placeholder="과세금액을 입력하세요"
/>

<ApiParameterCard
  name="vatAmt"
  type="string(12)"
  required={false}
  description="부가세금액입니다. 복합과세일 경우 필수입니다."
  example="91"
  inputType="text"
  defaultValue="91"
  placeholder="부가세금액을 입력하세요"
/>

<ApiParameterCard
  name="taxFreeAmt"
  type="string(12)"
  required={false}
  description="면세금액입니다. 복합과세일 경우 필수입니다."
  example="0"
  inputType="text"
  defaultValue="0"
  placeholder="면세금액을 입력하세요"
/>

<ApiParameterCard
  name="svcAmt"
  type="string(12)"
  required={false}
  description="신용카드 봉사료입니다."
  example="10"
  inputType="text"
  defaultValue="10"
  placeholder="봉사료를 입력하세요"
/>

<ApiParameterCard
  name="instmtMon"
  type="string(2)"
  required={false}
  description="할부개월수입니다."
  example="00"
  values={[
    "00: 일시불",
    "02: 2개월",
    "03: 3개월",
    "04: 4개월",
    "05: 5개월",
    "06: 6개월",
    "07: 7개월",
    "08: 8개월",
    "09: 9개월",
    "10: 10개월",
    "11: 11개월",
    "12: 12개월"
  ]}
  inputType="text"
  defaultValue="00"
  placeholder="할부개월수를 입력하세요"
/>

<ApiParameterCard
  name="cardType"
  type="string(1)"
  required={false}
  description="카드결제타입입니다."
  example="3"
  values={[
    "3: 앱카드 전용가능 카드사[신한/삼성/현대/KB/농협/롯데]",
    "6: 현대카드 PayShot(카드사와 직접 제휴계약 진행 후 사용가능)"
  ]}
  inputType="text"
  defaultValue="3"
  placeholder="카드결제타입을 입력하세요"
/>

<ApiParameterCard
  name="chainUserId"
  type="string(100)"
  required={false}
  description="현대카드 PayShot ID입니다. 카드사와 직접 제휴계약 진행 후 사용 가능합니다."
  example=""
  inputType="text"
  defaultValue=""
  placeholder="PayShot ID를 입력하세요"
/>

<ApiParameterCard
  name="cardGb"
  type="string(4)"
  required={false}
  description="특정카드사 코드입니다. 하나의 특정 카드사만 노출됩니다."
  example="NHC"
  inputType="text"
  defaultValue="NHC"
  placeholder="카드사 코드를 입력하세요"
/>

<ApiParameterCard
  name="appScheme"
  type="string(100)"
  required={false}
  description="앱스키마입니다. (AppScheme://~)형식으로 사용되며, 자체앱을 구축하는 경우 사용합니다."
  example="PAYAPPNAME://"
  inputType="text"
  defaultValue="PAYAPPNAME://"
  placeholder="앱스키마를 입력하세요"
/>

<ApiParameterCard
  name="custIp"
  type="string(15)"
  required={false}
  description="고객 IP주소입니다. 상점 서버의 IP가 아닌, 고객 기기의 IP주소입니다."
  example="127.0.0.1"
  inputType="text"
  defaultValue="127.0.0.1"
  placeholder="고객 IP주소를 입력하세요"
/>

<ApiParameterCard
  name="pktHash"
  type="string(200)"
  required={true}
  description="SHA256 방식으로 생성한 해쉬값입니다."
  example="f395b6725a9a18f2563ce34f8bc76698051d27c05e5ba815f463f00429061c0c"
  inputType="text"
  defaultValue="f395b6725a9a18f2563ce34f8bc76698051d27c05e5ba815f463f00429061c0c"
  placeholder="SHA256 해쉬값을 입력하세요"
  fixed={true}
  note="🔒 상점아이디 + 결제수단 + 상점주문번호 + 요청일자 + 요청시간 + 거래금액(평문) + 해쉬키 순서로 조합"
/>

## 해쉬 생성 방법

해쉬값은 다음 순서로 조합하여 SHA256으로 생성합니다:

```
상점아이디 + 결제수단 + 상점주문번호 + 요청일자 + 요청시간 + 거래금액(평문) + 해쉬키
```

## 응답 파라미터

### 성공 응답

<DocParameterCard
  name="mchtId"
  type="string"
  required={true}
  description="헥토파이낸셜에서 부여하는 고유 상점아이디"
  example="nxca_jt_il"
/>

<DocParameterCard
  name="outStatCd"
  type="string"
  required={true}
  description="거래상태코드"
  example="0021"
  values={[
    "0021: 성공",
    "0031: 실패"
  ]}
/>

<DocParameterCard
  name="outRsltCd"
  type="string"
  required={true}
  description="결과코드"
  example="0000"
  values={[
    "0000: 성공",
    "기타: 실패코드"
  ]}
/>

<DocParameterCard
  name="outRsltMsg"
  type="string"
  required={true}
  description="결과메시지"
  example="정상처리"
/>

<DocParameterCard
  name="method"
  type="string"
  required={true}
  description="결제수단"
  example="card"
/>

<DocParameterCard
  name="mchtTrdNo"
  type="string"
  required={true}
  description="상점에서 생성하는 고유 주문번호"
  example="ORDER20211231100000"
/>

<DocParameterCard
  name="trdNo"
  type="string"
  required={true}
  description="헥토파이낸셜에서 부여하는 고유 거래번호"
  example="STFP_PGCAnxca_jt_il0211129135810M1494620"
/>

<DocParameterCard
  name="trdAmt"
  type="string"
  required={true}
  description="거래금액"
  example="1000"
/>

<DocParameterCard
  name="mchtParam"
  type="string"
  required={false}
  description="상점예약필드 (요청시 전송한 값 그대로 반환)"
  example="name=HongGilDong&age=25"
/>

<DocParameterCard
  name="authDt"
  type="string"
  required={true}
  description="승인일시 (YYYYMMDDHHMMSS)"
  example="20211231100000"
/>

<DocParameterCard
  name="authNo"
  type="string"
  required={true}
  description="승인번호"
  example="30001234"
/>

<DocParameterCard
  name="intMon"
  type="string"
  required={true}
  description="할부개월수"
  example="00"
  values={[
    "00: 일시불",
    "02: 2개월",
    "03: 3개월",
    "기타: 해당 개월수"
  ]}
/>

<DocParameterCard
  name="fnNm"
  type="string"
  required={true}
  description="카드사명"
  example="우리카드"
/>

<DocParameterCard
  name="fnCd"
  type="string"
  required={true}
  description="카드사코드"
  example="LTC"
/>

#
<DocParameterCard
  name="billKey"
  type="string"
  required={false}
  description="빌키 (자동결제키, 빌키 서비스 이용시에만 발급)"
  example="SBILL_0123456789"
  note="빌키 서비스 별도 신청 필요"
/>

### 실패 응답

<DocParameterCard
  name="outStatCd"
  type="string"
  required={true}
  description="거래상태코드"
  example="0031"
  values={[
    "0031: 실패"
  ]}
/>

<DocParameterCard
  name="outRsltCd"
  type="string"
  required={true}
  description="거절코드"
  example="1001"
  values={[
    "1001: 결제 요청 정보 누락",
    "기타: 각종 오류코드"
  ]}
/>

<DocParameterCard
  name="outRsltMsg"
  type="string"
  required={true}
  description="결과메시지"
  example="결제 요청 정보 누락 (상품명)"
/>

#
실패 시에는 추가 데이터가 비어있습니다.

## 노티 전문

거래가 정상적으로 완료되면, 헥토파이낸셜에서 가맹점으로 노티(결과통보) 메세지가 전송됩니다.

### 노티 응답

가맹점에서 헥토파이낸셜로 응답을 전송해야 합니다:

| 응답 | 설명 |
|------|------|
| "OK" | 성공시 (대문자) |
| "FAIL" | 실패시 (대문자, FAIL로 응답시 명확한 실패로 인식합니다. 노티가 재전송 됩니다.) |
| 그 외 | 비정상 실패로 인식하여, 설정된 횟수만큼 노티 재발송 처리함. |

## WebView 설정

### 안드로이드

WebViewClient 클래스의 shouldOverrideUrlLoading 메소드를 재정의하여 외부 앱 호출을 처리합니다.

### iOS

URL Scheme 설정을 위해 plist 파일에 `LSApplicationQueriesSchemes key`에 App Schema를 등록해야 합니다.

## 에러 코드

자세한 에러 코드는 [거절 코드 표](/docs/api/pg/credit-card/error-codes)를 참고하세요.
